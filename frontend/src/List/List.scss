.table {
   --row-height: 25px;       /* must match ROW_HEIGHT in javascript */
   --th-padding-top: 3px;
   --exp-padding-left: 0px;  /* space for expanders if needed */

   display: flex;
   flex-flow: column nowrap;
   width: 100%;
   height: 100%;

   .tbody {
      min-height: 20px;
   }

   .tr {
      display: flex;
      flex-flow: row nowrap;
      line-height: var(--row-height);
      height: var(--row-height);
      box-sizing: border-box;
   }
   .trgroup {
      width: 100%;
   }
   .th,
   .td {
      display: inline-block;

      // Basis value doesn't matter. We just want all columns to request the
      // same amount when they do not specify an explicit width, that way
      // columns stay aligned. Otherwise, if column 1's content is large in
      // row 1 than in row2, they will not be aligned.
      flex: 1 1 100px;

      border-style: solid;
      border-color: var(--table-color);
      border-width: var(--table-horiz-border-width) var(--table-vert-border-width);
      box-sizing: border-box;
      padding: var(--th-padding-top) 5px;
      overflow: hidden;  /* obey column sizes */
      min-width: 20px;
      white-space: nowrap;  /* lines should always use constant height */
      text-overflow: ellipsis;
      text-align: left;     // Default alignment
   }
   .th {
      font-weight: bold;
   }
   .thead .tr {
      border-bottom: 1px solid var(--table-color);
   }
   .tfoot .tr {
      border-top: 1px solid var(--table-color);
   }

   /**
    * Always display the scrollbar: otherwise it ends up resizing the width of
    * tbody when it appears, and the header's width is no longer in sync. We
    * style it to make it less like a gray block though, using either standard
    * CSS (firefox), or -webkit specific ones (Chrome + Safari)
    *    https://alligator.io/css/css-scrollbars/
    */

   // ??? Behavior in firefox is inconsistent: sometimes the scrollbar overlaps
   // the tbody, sometimes it is displayed besides it.
   .tbody .tr {
      width: 100%;
   }

   .thead .tr,
   .tfoot .tr {
      // Thanks to box-sizing, we do not have to take into account
      // exp-padding-left when we compute the size
      width: calc(100% - var(--scrollbar-width));
   }
   .tbody > div {
      scrollbar-color: var(--scrollbar-fg) var(--scrollbar-bg);  /* firefox */

      &::-webkit-scrollbar {
         width: auto;
      }
      &::-webkit-scrollbar-track {
         background: var(--scrollbar-bg);
      }
      &::-webkit-scrollbar-thumb {
         background-color: var(--scrollbar-fg);
         border-radius: 20px;
         border: 3px solid var(--scrollbar-border);
      }
   }

   /**
    * Show borders
    */
   &.borders {
      .tr + .tr {
         border-top: 1px solid var(--gray-100);
      }
      .td + .td,
      .th + .th {
         border-left: 1px solid var(--gray-100);
      }
      .trgroup {
         border: 1px solid var(--gray-400);
      }
   }

   /**
    * Alternate row colors
    */
   .tr.odd {
      background-color: var(--table-alternate-row);
   }

   /**
    * Expandable rows
    */
   &.expandableRows {
      --exp-padding-left: 16px;  // match JS INDENT_LEVEL

      .tr.expandable .td:first-child::before,
      .trgroup.expandable .td:first-child::before {
         content: '';
         font: normal normal normal 14px/1 FontAwesome;
         text-rendering: auto;
         width: var(--exp-padding-left);
         margin-left: calc(var(--exp-padding-left) * -1);
         font-size: 1.4em;
         margin-top: 5px;
         -webkit-font-smoothing: antialiased;
         -moz-osx-font-smoothing: grayscale;
         display: block;
         cursor: pointer;
         float: left;
         color: var(--expand-arrow-color);

         position: absolute; // arrow not hidden by the cell's overflow:hidden
      }
      .tr.collapsed,
      .trgroup.collapsed {
         .tr:not(:first-child) .th,
         .tr:not(:first-child) .td {
            transition: height 0.2s, padding 0.2s;
            height: 0;
            padding: 0 0;
         }
         & .td:first-child::before {
            content: "\f0da";
            transform: rotateZ(0) translate(25%,0%);
            transition: transform 0.2s;
         }
      }
      .tr.expanded,
      .trgroup.expanded {
         .tr:not(:first-child) .th,
         .tr:not(:first-child) .td {
            transition: height 0.2s, padding 0.2s;
         }
         & .td:first-child::before {
            content: "\f0da";
            transform: rotateZ(90deg) translate(25%,0%);
            transition: transform 0.2s;
         }
      }

      .tr,
      .trgroup {
         padding-left: var(--exp-padding-left);
      }
      .trgroup .tr {
         padding-left: 0;
      }
   }

   /**
    * Highlight row under the mouse cursor. Rows can be grouped so that they
    * are all highlighted when the mouse is over any of them, used for split
    * transactions.
    */
   .tbody .trgroup:hover .tr,
   .tbody .tr:hover {
      background: var(--table-hover-background);
   }

   /**
    * Show sorting icons
    */
   .thead {
      .th.sorted-down:after,
      .th.sorted-up:after,
      .tr:hover .th.sortable:after {
         display: inline-block;
         font: normal normal normal 14px/1 FontAwesome;
         text-rendering: auto;
         margin-left: 5px;
         -webkit-font-smoothing: antialiased;
         -moz-osx-font-smoothing: grayscale;
      }
      .th.sortable {
         cursor: pointer;  /* indicate that we can sort by clicking */
      }
      .tr:hover .th.sortable:after {
         content: "\f0dc";
         position: absolute;  /* do not impact the rest of the layout */
         padding-top: var(--th-padding-top);
      }
      .tr:hover .th.sortable.sorted-down:after,
      .th.sorted-down:after {
         content: "\f0de";
      }
      .tr:hover .th.sortable.sorted-up:after,
      .th.sorted-up:after {
         content: "\f0dd";
      }
   }

   /**
    * Some standard sizing for columns.
    * Do not use units like 'ch' since they depend on the font-weight and would
    * result in different widths in header and body unfortunately.
    */
   .date {
      flex: 0 1 75px;
   }
   .td.date {
      font-family: "minion pro", "myriad pro", "tahoma";
      font-variant-numeric: oldstyle-nums tabular-nums;
      font-variant-numeric: lining-nums tabular-nums;
      font-size-adjust: 0.438;
   }
   .price {
      flex: 0 1 65px;
      text-align: right;
   }
   .amount {
      flex: 0 1 90px;
      text-align: right;
   }
   .percent {
      flex: 0 1 70px;
      text-align: right;
   }
   .closed {
      flex: 0 1 70px;
   }
}

.table .tbody {
   flex: 1 1;  /* needed for proper sizing of the react-window */
}

/* Warning for inconsistent data */
.table .td.warn:before {
   content: '\f06a';
   font: normal normal normal 14px/1 FontAwesome;
   margin-right: 2px;
   color: #f2e154;
}
